version: '3.4'

services:      
  client:
    image: kirill753/ticket-booking-api:client
    ports: 
      - "3000:3000"   
    networks:
      - mynet         
    depends_on:
      - ticketbookingapi
      - identityapi

  identityapi:
    image: kirill753/ticket-booking-api:identityapi
    ports: 
      - "8000:8000"
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://+:8000
      - ASPNETCORE_HTTP_PORTS=8000
    networks:
      - mynet   
    depends_on:
      - db2
      
  ticketbookingapi:
    image: kirill753/ticket-booking-api:ticketbookingapi
    ports: 
      - "80:80"
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
    networks:
      - mynet
    depends_on:
      - db  
   
  db:
    image: justin2004/mssql_server_tiny:latest
    ports:
      - "1433:1433"
    environment:
      SA_PASSWORD: "securePassword1*"
      ACCEPT_EULA: "Y"
    networks:
      - mynet
      
  db2:
    image: justin2004/mssql_server_tiny:latest
    ports:
      - "1434:1434"
    environment:
      SA_PASSWORD: "securePassword1*"
      ACCEPT_EULA: "Y"
    networks:
      - mynet
      
networks:
  mynet:
    driver: bridge